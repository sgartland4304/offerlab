<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Gallery</title>
  <script src="https://cdn.jsdelivr.net/npm/@mux/mux-player@latest" defer></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--content-background-elevated); overflow-x: hidden; min-height: 100vh; }

    :root {
      --content-background-base: #F7F5F0;
      --content-background-elevated: #FFF;
      --content-primary: #342E26;
      --content-border-neutral: rgba(52, 46, 38, 0.08);
      --rounded-4xl: 24px;
      --rounded-full: 99999px;
      --rounded-lg: 10px;
    }

    .gallery-container { max-width: 667px; padding: 0 24px; display: flex; flex-direction: column; justify-content: center; gap: 16px; }
    .gallery-viewport { width: 100%; height: 65vh; max-height: 480px; display: flex; align-items: center; justify-content: center; position: relative; overflow: visible; }
    .gallery-track { width: 100%; height: 100%; position: relative; }
    .fullscreen-image-container .gallery-track { width: 100%; height: 100%; }

    .gallery-slide {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      display: flex; align-items: center; justify-content: center;
      opacity: 0; transform: scale(0.95);
      transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: none;
    }
    .gallery-slide.active { opacity: 1; transform: scale(1); pointer-events: auto; }
    .gallery-slide img, .gallery-slide video, .gallery-slide mux-player {
      max-width: 100%; max-height: 100%; width: auto; height: auto; object-fit: contain; display: block;
      border-radius: var(--rounded-4xl);
    }
    .gallery-slide:has(mux-player), .gallery-slide:has(video) {
      border-radius: var(--rounded-4xl);
      overflow: hidden;
    }
    /* Video slide: wrap sizes to source aspect ratio via JS; whole player (video + controls) fits video */
    .gallery-slide .video-slide-wrap {
      position: relative;
      max-width: 100%;
      max-height: 100%;
      border-radius: var(--rounded-4xl);
      overflow: hidden;
      flex-shrink: 0;
      /* width/height set in px by JS from source dimensions; default 16:9 before load */
      aspect-ratio: 16 / 9;
    }
    .gallery-slide .video-slide-wrap > mux-player,
    .gallery-slide .video-slide-wrap > video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      cursor: pointer;
    }
    .gallery-slide mux-player {
      --media-object-fit: contain;
      --media-object-position: center;
      --controls: none;
    }
    /* Apple TV+ style: tall blur-fade overlay behind controls, bottomâ†’top to 0% */
    .video-blur-fade {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 20%;
      max-height: 96px;
      z-index: 0;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
      border-bottom-left-radius: var(--rounded-4xl);
      border-bottom-right-radius: var(--rounded-4xl);
      background: linear-gradient(to top,
        rgba(0, 0, 0, 0.62) 0%,
        rgba(0, 0, 0, 0.42) 22%,
        rgba(0, 0, 0, 0.22) 45%,
        rgba(0, 0, 0, 0.08) 70%,
        rgba(0, 0, 0, 0.02) 88%,
        rgba(0, 0, 0, 0) 100%
      );
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      -webkit-mask-image: linear-gradient(to top,
        black 0%,
        rgba(0, 0, 0, 0.97) 12%,
        rgba(0, 0, 0, 0.88) 28%,
        rgba(0, 0, 0, 0.68) 48%,
        rgba(0, 0, 0, 0.38) 70%,
        rgba(0, 0, 0, 0.12) 88%,
        transparent 100%
      );
      mask-image: linear-gradient(to top,
        black 0%,
        rgba(0, 0, 0, 0.97) 12%,
        rgba(0, 0, 0, 0.88) 28%,
        rgba(0, 0, 0, 0.68) 48%,
        rgba(0, 0, 0, 0.38) 70%,
        rgba(0, 0, 0, 0.12) 88%,
        transparent 100%
      );
    }
    /* Chrome-style control bar: buttons row + track on its own row; visible on hover only */
    .chrome-controls {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      padding: 0 4px 16px;
      gap: 6px;
      background: transparent;
      pointer-events: none;
      z-index: 1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .chrome-controls-row {
      display: flex;
      align-items: center;
      gap: 4px;
      min-height: 36px;
    }
    .chrome-controls-row .spacer { flex: 1; min-width: 0; }
    .video-slide-wrap:hover .video-blur-fade,
    .video-slide-wrap:hover .chrome-controls {
      opacity: 1;
    }
    .video-slide-wrap:hover .chrome-controls {
      pointer-events: auto;
    }
    .chrome-controls button {
      position: relative;
      width: 36px;
      height: 36px;
      border: none;
      background: transparent;
      color: #fff;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    .chrome-controls button:hover { opacity: 0.9; }
    /* Hover circle with glassy effect for all control buttons (play/pause, mute, fullscreen) */
    .chrome-controls button::before {
      content: '';
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 32px;
      height: 32px;
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
      z-index: 0;
    }
    .chrome-controls button:hover::before {
      opacity: 1;
      background-color: rgba(0, 0, 0, 0.85);
      box-shadow: rgba(255, 255, 255, 0.2) 0px 1px 0px 0px inset, rgba(0, 0, 0, 0.12) 0px 0px 1px 0px, rgba(0, 0, 0, 0.12) 0px 4px 8px 0px;
      border: 0.5px solid rgb(255, 255, 255, 0.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      background-image: linear-gradient(180deg, #ffffff05, #fff0 40%, #00000005);
    }
    .chrome-controls button svg {
      position: relative;
      z-index: 1;
      width: 22px;
      height: 22px;
      fill: currentColor;
    }
    .chrome-controls .time {
      color: #fff;
      font-size: 12px;
      font-family: system-ui, sans-serif;
      white-space: nowrap;
      padding: 0 4px;
    }
    .chrome-controls .scrubber-wrap {
      width: 100%;
      display: flex;
      align-items: center;
      padding: 0 8px;
    }
    .chrome-controls input[type="range"] {
      width: 100%;
      height: 4px;
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      --p: 0%;
    }
    .chrome-controls input[type="range"]::-webkit-slider-runnable-track {
      height: 4px;
      background: linear-gradient(to right, #fff var(--p), rgba(255, 255, 255, 0.3) var(--p));
      border-radius: 2px;
    }
    .chrome-controls input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #fff;
      margin-top: -4px;
      cursor: pointer;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }
    .chrome-controls input[type="range"]::-moz-range-track {
      height: 4px;
      background: linear-gradient(to right, #fff var(--p), rgba(255, 255, 255, 0.3) var(--p));
      border-radius: 2px;
    }
    .chrome-controls input[type="range"]::-moz-range-thumb {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #fff;
      border: none;
      cursor: pointer;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .gallery-nav-btn {
      width: 44px; height: 44px; padding: 12px; border-radius: var(--rounded-full);
      border: 1px solid var(--content-border-neutral);
      background: var(--content-background-elevated);
      box-shadow: 0 0 2px 0 rgba(0,0,0,0.05), 0 4px 6px 0 rgba(0,0,0,0.02);
      cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease;
    }
    .gallery-nav-btn:hover { background: var(--content-background-base); }
    .gallery-nav-btn:active { transform: scale(0.95); }
    .gallery-nav-btn svg { width: 16px; height: 16px; flex-shrink: 0; }

    .thumbnail-nav-wrapper { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
    .nav-controls { display: flex; gap: 8px; flex-shrink: 0; }
    /* Scrollable thumbnail strip: fixed-size thumbs, right-edge fade */
    .thumbnail-container {
      flex: 1;
      min-width: 0;
      display: flex;
      gap: 6px;
      overflow-x: auto;
      padding: 8px 0;
      scrollbar-width: none;
      -ms-overflow-style: none;
      position: relative;
      scroll-behavior: smooth;
    }
    .thumbnail-container::-webkit-scrollbar { display: none; }
    /* Subtle white gradient on the right edge so the last thumb fades as it clips */
    .thumbnail-container::after {
      content: '';
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 32px;
      background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.95));
      pointer-events: none;
    }
    .thumbnail-btn {
      width: 48px;
      height: 48px;
      min-width: 48px;
      min-height: 48px;
      flex-shrink: 0;
      aspect-ratio: 1 / 1;
      border-radius: var(--rounded-lg);
      opacity: 0.8;
      overflow: hidden;
      cursor: pointer;
      border: none;
      transition: opacity 0.15s ease;
      position: relative;
      background: var(--content-background-base);
    }
    .thumbnail-btn img, .thumbnail-btn video, .thumbnail-btn mux-player { width: 100%; height: 100%; object-fit: cover; display: block; }
    .thumbnail-border-overlay {
      position: absolute; inset: 0; border: 2px solid var(--content-primary); border-radius: var(--rounded-lg);
      opacity: 0; pointer-events: none; transition: opacity 0.15s ease;
    }
    .thumbnail-btn:hover, .thumbnail-btn.active { opacity: 1; }
    .thumbnail-btn:hover .thumbnail-border-overlay, .thumbnail-btn.active .thumbnail-border-overlay { opacity: 1; }

    /* Full-screen overlay */
    .fullscreen-overlay {
      position: fixed; inset: 0; background: var(--content-background-base); z-index: 9999; pointer-events: auto;
      display: none; align-items: center; justify-content: center; opacity: 0;
      transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .fullscreen-overlay.active { opacity: 1; }
    .fullscreen-content {
      position: fixed; inset: 0; display: flex; margin: 8px; padding: 12px;
      border-radius: 20px; border: 1px solid var(--content-border-neutral); background: var(--content-background-elevated);
      overflow: hidden; transform: scale(0.95); opacity: 0;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .fullscreen-overlay.active .fullscreen-content { transform: scale(1); opacity: 1; }
    .fullscreen-image-container { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; }

    /* Close button: desktop = transparent, hover shows overlay bg */
    .fullscreen-close-btn {
      position: absolute; top: 24px; right: 24px; width: 40px; height: 40px; border-radius: 50%;
      background: transparent; border: none; cursor: pointer;
      display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; z-index: 10001;
    }
    .fullscreen-close-btn:hover { background: var(--content-background-base); }
    .fullscreen-close-btn svg { width: 20px; height: 20px; stroke: var(--content-interactive-primary, #342E26); }

    /* Fullscreen nav arrows: desktop = same as close (transparent, hover overlay) */
    .fullscreen-nav-controls {
      position: absolute; bottom: 24px; right: 24px; display: flex; gap: 8px; z-index: 10001;
    }
    .fullscreen-nav-btn {
      width: 44px; height: 44px; padding: 12px; border-radius: var(--rounded-full);
      border: 1px solid var(--content-border-neutral); background: var(--content-background-elevated);
      box-shadow: 0 0 2px 0 rgba(0,0,0,0.05), 0 4px 6px 0 rgba(0,0,0,0.02);
      cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease;
    }
    .fullscreen-nav-btn:hover { background: var(--content-background-base); }
    .fullscreen-nav-btn:active { transform: scale(0.95); }
    .fullscreen-nav-btn svg { width: 16px; height: 16px; flex-shrink: 0; stroke: var(--content-interactive-primary, #342E26); }

    .fullscreen-slide-wrapper { width: 100%; height: 100%; display: flex; flex-direction: row; align-items: center; padding-bottom: 20px; }
    .fullscreen-slide { max-width: 100%; max-height: 100%; border-radius: 28px; display: flex; align-items: center; justify-content: center; padding: 80px; }
    .fullscreen-slide img { max-width: 100%; max-height: 100%; width: auto; height: auto; object-fit: contain; display: block; border-radius: 28px; }
    .fullscreen-slide .video-slide-wrap {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 28px;
      overflow: hidden;
    }
    .fullscreen-slide .video-slide-wrap > mux-player,
    .fullscreen-slide .video-slide-wrap > video {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      cursor: pointer;
    }
    .fullscreen-slide mux-player { --media-object-fit: contain; --media-object-position: center; --controls: none; }
    .fullscreen-slide .video-blur-fade { height: 20%; max-height: 72px; border-bottom-left-radius: 28px; border-bottom-right-radius: 28px; }
    .fullscreen-slide .chrome-controls { padding: 0 8px 8px; }
    .fullscreen-slide .chrome-controls-row { min-height: 40px; }
    .fullscreen-slide .chrome-controls button { width: 40px; height: 40px; }
    .fullscreen-slide .chrome-controls button::before { width: 36px; height: 36px; }
    .fullscreen-slide .chrome-controls button svg { width: 24px; height: 24px; }
    .fullscreen-slide .chrome-controls .time { font-size: 13px; }

    .fullscreen-thumbnails {
      z-index: 1; touch-action: pan-x; margin-left: 24px; align-self: center;
      display: flex; flex-direction: column; gap: 6px; overflow-y: auto; scrollbar-width: none; -ms-overflow-style: none;
    }
    .fullscreen-thumbnails::-webkit-scrollbar { display: none; }
    .fullscreen-thumbnail-btn {
      width: 48px; height: 48px; border-radius: var(--rounded-lg); opacity: 0.8; overflow: hidden;
      cursor: pointer; border: none; background: var(--content-background-base); flex-shrink: 0; position: relative;
    }
    .fullscreen-thumbnail-btn img, .fullscreen-thumbnail-btn video, .fullscreen-thumbnail-btn mux-player { width: 100%; height: 100%; object-fit: cover; display: block; }
    .fullscreen-thumbnail-btn .thumbnail-border-overlay { position: absolute; inset: 0; border: 2px solid var(--content-primary); border-radius: var(--rounded-lg); opacity: 0; pointer-events: none; }
    .fullscreen-thumbnail-btn:hover, .fullscreen-thumbnail-btn.active { opacity: 1; }
    .fullscreen-thumbnail-btn.active .thumbnail-border-overlay { opacity: 1; }
    .gallery-slide.active { cursor: zoom-in; }
    .gallery-slide.active:has(mux-player) { cursor: pointer; }
    .fullscreen-slide.active, .fullscreen-slide.active img, .fullscreen-slide.active video, .fullscreen-slide.active mux-player { cursor: pointer; }

    /* ----- Mobile: horizontal snap-scroll; 10px gap between slides, no extra spacing ----- */
    @media (max-width: 768px) {
      .gallery-container {
        padding: 0;
      }
      .thumbnail-nav-wrapper { display: none; }
      .gallery-viewport {
        height: 100%;
        max-height: 45vh;
        overflow-x: auto;
        overflow-y: hidden;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
        position: absolute;
        scroll-padding-left: 16px;
        scroll-padding-right: 16px;
      }
      .gallery-viewport::-webkit-scrollbar { display: none; }
      .gallery-track {
        display: flex;
        flex-direction: row;
        position: relative;
        height: 100%;
        gap: 10px;
        padding-left: 16px;
        padding-right: 16px;
      }
      .gallery-slide {
        position: relative;
        width: auto;
        max-width: calc(100vw - 32px);
        height: 100%;
        flex-shrink: 0;
        scroll-snap-align: center;
        scroll-snap-stop: normal;
        border-radius: 16px;
        overflow: hidden;
        /* Override fade: all slides visible in horizontal strip (no opacity/transform hide) */
        opacity: 1;
        transform: none;
        pointer-events: auto;
        transition: none;
      }
      .gallery-slide:last-child { 
        scroll-snap-align: end;
      padding-right: 16px; }
      .gallery-slide img,
      .gallery-slide video,
      .gallery-slide mux-player,
      .gallery-slide .video-slide-wrap {
        border-radius: 16px;
        opacity: 1;
      }
    }

    /* ----- Mobile fullscreen: full-bleed card, full-width slides, swipe, fade transition ----- */
    @media (max-width: 768px) {
      .fullscreen-overlay { padding: 0; }
      .fullscreen-content {
        margin: 0;
        padding: 0;
        border-radius: 0;
        border: none;
        box-shadow: none;
        max-width: none;
        width: 100%;
        height: 100%;
        gap: 0;
        background: #fff;
      }
      .fullscreen-thumbnails { display: none; }
      .fullscreen-image-container { padding: 0; }

      /* Track in fullscreen: stacked slides (not horizontal strip), one visible at a time */
      .fullscreen-image-container .gallery-track {
        display: block;
        flex-direction: unset;
        gap: 0;
        padding: 0;
        position: relative;
        width: 100%;
        height: 100%;
      }
      .fullscreen-image-container .fullscreen-slide-wrapper {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }
      .fullscreen-image-container .fullscreen-slide-wrapper .gallery-slide { pointer-events: auto; }

      /* Active slide full width, no radius; desktop-style fade/scale transition */
      .fullscreen-image-container .gallery-slide,
      .fullscreen-image-container .fullscreen-slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        border-radius: 0;
        max-width: none;
        opacity: 0;
        transform: scale(0.95);
        transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .fullscreen-image-container .gallery-slide.active,
      .fullscreen-image-container .fullscreen-slide.active {
        opacity: 1;
        transform: scale(1);
      }
      .fullscreen-image-container .gallery-slide img,
      .fullscreen-image-container .gallery-slide video,
      .fullscreen-image-container .gallery-slide mux-player,
      .fullscreen-image-container .fullscreen-slide .video-slide-wrap {
        border-radius: 0;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
      }
      .fullscreen-image-container .gallery-slide video,
      .fullscreen-image-container .gallery-slide mux-player { width: auto; height: auto; }

      /* Pagination arrows: centered on mobile; button styles match desktop */
      .fullscreen-nav-controls {
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        justify-content: center;
      }
      .fullscreen-nav-btn:hover {
        background: var(--content-background-elevated);
      }
      .fullscreen-nav-btn:active {
        background: var(--content-background-base);
      }

      /* Close button: overlay bg by default on mobile */
      .fullscreen-close-btn {
        top: 16px;
        right: 16px;
        background: var(--content-background-base);
        color: #fff;
      }
      .fullscreen-close-btn svg {
        stroke: var(--content-interactive-primary, #342E26);
      }
      .fullscreen-close-btn:hover {
        background: rgba(52, 46, 38, 0.12);
      }
    }
  </style>
</head>
<body>
  <div class="gallery-container">
    <div class="gallery-viewport" id="galleryViewport">
      <div class="gallery-track" id="galleryTrack"></div>
    </div>
    <div class="thumbnail-nav-wrapper">
      <div class="thumbnail-container" id="thumbnails"></div>
      <div class="nav-controls">
        <button class="gallery-nav-btn prev" id="prevBtn" aria-label="Previous"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M9.99984 13.3332L4.6665 7.99985L9.99984 2.6665" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
        <button class="gallery-nav-btn next" id="nextBtn" aria-label="Next"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6.00016 2.6665L11.3335 7.99985L6.00016 13.3332" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
      </div>
    </div>
  </div>

  <div class="fullscreen-overlay" id="fullscreenOverlay">
    <div class="fullscreen-content">
      <button class="fullscreen-close-btn" id="fullscreenCloseBtn" aria-label="Close">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
      <div class="fullscreen-thumbnails" id="fullscreenThumbnails"></div>
      <div class="fullscreen-image-container" id="fullscreenImageContainer"></div>
      <div class="fullscreen-nav-controls">
        <button class="fullscreen-nav-btn" id="fullscreenPrevBtn" aria-label="Previous"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 16 16" fill="none"><path d="M9.99984 13.3332L4.6665 7.99985L9.99984 2.6665" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
        <button class="fullscreen-nav-btn" id="fullscreenNextBtn" aria-label="Next"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 16 16" fill="none"><path d="M6.00016 2.6665L11.3335 7.99985L6.00016 13.3332" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
      </div>
    </div>
  </div>

  <script>
    // Images: { type: 'image', src: 'assets/filename.jpg' }
    // Videos (Mux): { type: 'video', playbackId: '...' }
    // Videos (local): { type: 'video', src: 'assets/file.mp4', poster: 'assets/thumb.jpg' }
    const galleryMedia = [
      { type: 'image', src: 'assets/OSEA_DreamNightSerum_DNS-1_Frontal_1000x1275_4f5a73ac-bbfb-4e40-be0c-bb06372a68e5.webp' },
      { type: 'image', src: 'assets/OSEA_DreamNightSerum_DNS-1_Model4_1000x1275_1197d51c-9fef-4fe9-a7f9-434d05a597fa.webp' },
      { type: 'image', src: 'assets/OSEA_DreamNightSerum_DNS-1_Overhead_1000x1275_1c7d620f-762c-4e5f-b358-60c8b073f36e.webp' },
      { type: 'image', src: 'assets/OSEADTCDNSConsumerResults1000X1275.webp' },
      { type: 'image', src: 'assets/OSEADTCDNSConsumerResultsB_A1-1000X1275.jpg' },
      { type: 'image', src: 'assets/OSEADTCDNSConsumerResultsB_A2-1000X1275.avif' },
      { type: 'image', src: 'assets/SiteDTCPDPBenefits-DNS.avif' },
      { type: 'image', src: 'assets/SiteDTCPDPSerumsCompChartInfographic-DNS.webp' },
      { type: 'image', src: 'assets/SiteDTCPDPStylizedFranchiseShot-DNS_c32aa7c1-5808-4d12-8d50-e3ab3a961e7b.avif' },
      { type: 'image', src: 'assets/DNS-1_RH_SCAN_1052-V.3_f8d7c224-080f-400d-a1ce-bad5575cbe4d.avif' },
      { type: 'video', playbackId: '1hVDthP6v6ns5YZ8OshtGOnm7jJbPoQSN7pc028a00j24', thumbnail: 'https://image.mux.com/1hVDthP6v6ns5YZ8OshtGOnm7jJbPoQSN7pc028a00j24/thumbnail.png?width=214&height=121&time=0' },
    ];
    let currentIndex = 0;
    const track = document.getElementById('galleryTrack');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const thumbnailContainer = document.getElementById('thumbnails');
    const fullscreenOverlay = document.getElementById('fullscreenOverlay');
    const fullscreenImageContainer = document.getElementById('fullscreenImageContainer');
    const fullscreenCloseBtn = document.getElementById('fullscreenCloseBtn');
    const fullscreenPrevBtn = document.getElementById('fullscreenPrevBtn');
    const fullscreenNextBtn = document.getElementById('fullscreenNextBtn');
    const fullscreenThumbnails = document.getElementById('fullscreenThumbnails');
    const galleryViewport = document.getElementById('galleryViewport');

    function pauseAllVideos() {
      track.querySelectorAll('mux-player').forEach(p => { try { p.pause(); } catch (_) {} });
      track.querySelectorAll('video').forEach(v => { try { v.pause(); } catch (_) {} });
    }

    function applySourceAspectRatio(player, wrap) {
      function getDimensions() {
        const v = player.tagName === 'VIDEO' ? player : (player.media?.nativeEl || player.querySelector?.('video') || player);
        return v && v.videoWidth && v.videoHeight ? { w: v.videoWidth, h: v.videoHeight } : null;
      }
      function sizeWrap() {
        const dim = getDimensions();
        if (!dim || !wrap.parentElement) return;
        const parent = wrap.parentElement;
        const pw = parent.clientWidth, ph = parent.clientHeight;
        if (!pw || !ph) return;
        const { w, h } = dim;
        const r = w / h;
        let cw, ch;
        if (pw / ph >= r) { ch = ph; cw = ch * r; } else { cw = pw; ch = cw / r; }
        wrap.style.width = Math.round(cw) + 'px';
        wrap.style.height = Math.round(ch) + 'px';
        wrap.style.aspectRatio = w + ' / ' + h;
      }
      player.addEventListener('loadedmetadata', sizeWrap);
      if (wrap.parentElement) {
        const ro = new ResizeObserver(sizeWrap);
        ro.observe(wrap.parentElement);
      }
      if (getDimensions()) sizeWrap();
    }

    function createMuxPlayer(playbackId) {
      const player = document.createElement('mux-player');
      player.setAttribute('playback-id', playbackId);
      player.setAttribute('nohotkeys', '');
      player.setAttribute('stream-type', 'on-demand');
      player.setAttribute('preload', 'auto');
      return player;
    }

    function iconSVG(name) {
      const icons = {
        play: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>',
        pause: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 4h4v16H6zm8 0h4v16h-4z"/></svg>',
        volume: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/></svg>',
        mute: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>',
        fullscreen: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>',
        fullscreenExit: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg>'
      };
      const div = document.createElement('div');
      div.innerHTML = icons[name] || '';
      return div.firstChild;
    }

    function formatTime(s) {
      if (!isFinite(s) || s < 0) return '0:00';
      const m = Math.floor(s / 60), sec = Math.floor(s % 60);
      return m + ':' + (sec < 10 ? '0' : '') + sec;
    }

    function attachChromeControls(player, wrap) {
      const overlay = document.createElement('div');
      overlay.className = 'video-blur-fade';
      wrap.appendChild(overlay);
      const bar = document.createElement('div');
      bar.className = 'chrome-controls';
      const playBtn = document.createElement('button');
      playBtn.type = 'button';
      playBtn.className = 'play-pause-btn';
      playBtn.setAttribute('aria-label', 'Play');
      playBtn.appendChild(iconSVG('play'));
      const timeEl = document.createElement('span');
      timeEl.className = 'time';
      timeEl.textContent = '0:00 / 0:00';
      const scrubWrap = document.createElement('div');
      scrubWrap.className = 'scrubber-wrap';
      const scrubber = document.createElement('input');
      scrubber.type = 'range';
      scrubber.min = 0;
      scrubber.max = 100;
      scrubber.value = 0;
      scrubber.setAttribute('aria-label', 'Seek');
      scrubWrap.appendChild(scrubber);
      const muteBtn = document.createElement('button');
      muteBtn.type = 'button';
      muteBtn.setAttribute('aria-label', 'Mute');
      muteBtn.appendChild(iconSVG('volume'));
      const fsBtn = document.createElement('button');
      fsBtn.type = 'button';
      fsBtn.setAttribute('aria-label', 'Fullscreen');
      fsBtn.appendChild(iconSVG('fullscreen'));
      const row = document.createElement('div');
      row.className = 'chrome-controls-row';
      const spacer = document.createElement('span');
      spacer.className = 'spacer';
      spacer.setAttribute('aria-hidden', 'true');
      row.append(playBtn, timeEl, spacer, muteBtn, fsBtn);
      bar.append(row, scrubWrap);

      function updateTime() {
        const t = player.currentTime || 0, d = player.duration;
        timeEl.textContent = formatTime(t) + ' / ' + formatTime(d);
        if (!scrubber.dragging) {
          const pct = isFinite(d) && d > 0 ? (100 * t / d) : 0;
          scrubber.value = pct;
          scrubber.style.setProperty('--p', pct + '%');
        }
      }
      function updatePlayIcon() {
        playBtn.innerHTML = '';
        playBtn.appendChild(iconSVG(player.paused ? 'play' : 'pause'));
        playBtn.setAttribute('aria-label', player.paused ? 'Play' : 'Pause');
      }
      function updateMuteIcon() {
        muteBtn.innerHTML = '';
        muteBtn.appendChild(iconSVG(player.muted ? 'mute' : 'volume'));
        muteBtn.setAttribute('aria-label', player.muted ? 'Unmute' : 'Mute');
      }
      function updateFsIcon() {
        const full = !!document.fullscreenElement;
        fsBtn.innerHTML = '';
        fsBtn.appendChild(iconSVG(full ? 'fullscreenExit' : 'fullscreen'));
        fsBtn.setAttribute('aria-label', full ? 'Exit fullscreen' : 'Fullscreen');
      }

      playBtn.addEventListener('click', (e) => { e.stopPropagation(); player.paused ? player.play() : player.pause(); });
      muteBtn.addEventListener('click', (e) => { e.stopPropagation(); player.muted = !player.muted; });
      scrubber.addEventListener('input', () => {
        const d = player.duration;
        const pct = parseFloat(scrubber.value);
        scrubber.style.setProperty('--p', pct + '%');
        if (isFinite(d)) player.currentTime = (pct / 100) * d;
      });
      scrubber.addEventListener('mousedown', () => { scrubber.dragging = true; });
      scrubber.addEventListener('mouseup', () => { scrubber.dragging = false; });
      fsBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        const full = !!document.fullscreenElement;
        if (full) document.exitFullscreen();
        else wrap.requestFullscreen?.();
      });
      player.addEventListener('play', updatePlayIcon);
      player.addEventListener('pause', updatePlayIcon);
      player.addEventListener('volumechange', updateMuteIcon);
      player.addEventListener('timeupdate', updateTime);
      player.addEventListener('loadedmetadata', updateTime);
      player.addEventListener('durationchange', updateTime);
      document.addEventListener('fullscreenchange', updateFsIcon);

      bar.addEventListener('click', (e) => e.stopPropagation());
      updatePlayIcon();
      updateMuteIcon();
      updateFsIcon();
      updateTime();
      wrap.appendChild(bar);
    }

    function generateSlides() {
      galleryMedia.forEach((media, i) => {
        const slide = document.createElement('div');
        slide.className = `gallery-slide ${i === 0 ? 'active' : ''}`;
        let videoWrap, videoPlayer;
        if (media.type === 'image') {
          const img = document.createElement('img');
          img.src = media.src;
          img.alt = `Image ${i + 1}`;
          slide.appendChild(img);
        } else if (media.type === 'video' && media.playbackId) {
          const wrap = document.createElement('div');
          wrap.className = 'video-slide-wrap';
          const player = createMuxPlayer(media.playbackId);
          player.addEventListener('click', (e) => { e.stopPropagation(); player.paused ? player.play() : player.pause(); });
          wrap.appendChild(player);
          attachChromeControls(player, wrap);
          slide.appendChild(wrap);
          videoWrap = wrap;
          videoPlayer = player;
        } else if (media.type === 'video' && media.src) {
          const wrap = document.createElement('div');
          wrap.className = 'video-slide-wrap';
          const vid = document.createElement('video');
          vid.src = media.src;
          if (media.poster) vid.poster = media.poster;
          vid.playsInline = true;
          vid.muted = false;
          vid.addEventListener('click', (e) => { e.stopPropagation(); vid.paused ? vid.play() : vid.pause(); });
          wrap.appendChild(vid);
          attachChromeControls(vid, wrap);
          slide.appendChild(wrap);
          videoWrap = wrap;
          videoPlayer = vid;
        }
        track.appendChild(slide);
        if (videoWrap && videoPlayer) applySourceAspectRatio(videoPlayer, videoWrap);
      });
    }
    function thumbSrc(media) {
      if (media.type === 'image') return media.src;
      if (media.type === 'video' && media.thumbnail) return media.thumbnail;
      if (media.type === 'video' && media.playbackId) return `https://image.mux.com/${media.playbackId}/thumbnail.jpg?width=200&height=200&fit_mode=smartcrop`;
      if (media.type === 'video' && media.poster) return media.poster;
      return '';
    }
    function generateThumbnails() {
      galleryMedia.forEach((media, i) => {
        const thumb = document.createElement('button');
        thumb.className = `thumbnail-btn ${i === 0 ? 'active' : ''}`;
        const src = thumbSrc(media);
        if (src) { const img = document.createElement('img'); img.src = src; img.alt = ''; thumb.appendChild(img); }
        const overlay = document.createElement('div'); overlay.className = 'thumbnail-border-overlay'; thumb.appendChild(overlay);
        thumb.addEventListener('click', () => goToSlide(i));
        thumbnailContainer.appendChild(thumb);
      });
    }
    function playActiveSlideVideo() {
      const activeSlide = track.querySelector('.gallery-slide.active');
      if (!activeSlide) return;
      const player = activeSlide.querySelector('mux-player') || activeSlide.querySelector('video');
      if (player) { try { player.muted = false; player.play(); } catch (_) {} }
    }
    function updateActiveStates() {
      track.querySelectorAll('.gallery-slide').forEach((s, i) => s.classList.toggle('active', i === currentIndex));
      thumbnailContainer.querySelectorAll('.thumbnail-btn').forEach((t, i) => t.classList.toggle('active', i === currentIndex));
      const thumbs = thumbnailContainer.querySelectorAll('.thumbnail-btn');
      if (thumbs[currentIndex] && window.matchMedia('(min-width: 769px)').matches) thumbs[currentIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
      if (window.matchMedia('(max-width: 768px)').matches && galleryViewport.contains(track)) {
        const first = track.querySelector('.gallery-slide');
        if (first) {
          const gap = 10;
          galleryViewport.scrollTo({ left: currentIndex * (first.offsetWidth + gap), behavior: 'smooth' });
        }
      }
      playActiveSlideVideo();
    }
    function goToSlide(index) {
      if (index < 0 || index >= galleryMedia.length) return;
      pauseAllVideos();
      currentIndex = index;
      updateActiveStates();
    }
    function goToPrev() { goToSlide(currentIndex === 0 ? galleryMedia.length - 1 : currentIndex - 1); }
    function goToNext() { goToSlide(currentIndex === galleryMedia.length - 1 ? 0 : currentIndex + 1); }

    prevBtn.addEventListener('click', goToPrev);
    nextBtn.addEventListener('click', goToNext);

    let touchStartX = 0, touchEndX = 0, touchMoved = false;
    track.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; touchMoved = false; }, { passive: true });
    track.addEventListener('touchmove', () => { touchMoved = true; }, { passive: true });
    track.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      const swipe = Math.abs(touchStartX - touchEndX) > 50;
      if (window.matchMedia('(max-width: 768px)').matches && fullscreenOverlay.classList.contains('active')) {
        if (swipe) {
          (touchStartX - touchEndX > 0) ? goToNext() : goToPrev();
          updateFSThumbs();
        }
      } else if (window.matchMedia('(min-width: 769px)').matches && swipe) {
        (touchStartX - touchEndX > 0) ? goToNext() : goToPrev();
      }
    }, { passive: true });

    function syncCurrentIndexFromScroll() {
      if (!window.matchMedia('(max-width: 768px)').matches) return;
      const first = track.querySelector('.gallery-slide');
      if (!first) return;
      const w = first.offsetWidth;
      const gap = 10;
      const scrollLeft = galleryViewport.scrollLeft;
      const i = Math.round(scrollLeft / (w + gap));
      const idx = Math.max(0, Math.min(i, galleryMedia.length - 1));
      if (idx !== currentIndex) {
        currentIndex = idx;
        track.querySelectorAll('.gallery-slide').forEach((s, i) => s.classList.toggle('active', i === currentIndex));
        playActiveSlideVideo();
      }
    }
    galleryViewport.addEventListener('scroll', syncCurrentIndexFromScroll, { passive: true });
    galleryViewport.addEventListener('scrollend', syncCurrentIndexFromScroll);

    function generateFullscreenThumbnails() {
      fullscreenThumbnails.innerHTML = '';
      galleryMedia.forEach((media, i) => {
        const thumb = document.createElement('button');
        thumb.className = `fullscreen-thumbnail-btn ${i === currentIndex ? 'active' : ''}`;
        const src = thumbSrc(media);
        if (src) { const img = document.createElement('img'); img.src = src; thumb.appendChild(img); }
        const o = document.createElement('div'); o.className = 'thumbnail-border-overlay'; thumb.appendChild(o);
        thumb.addEventListener('click', () => { currentIndex = i; updateActiveStates(); updateFSThumbs(); });
        fullscreenThumbnails.appendChild(thumb);
      });
    }
    function updateFSThumbs() {
      fullscreenThumbnails.querySelectorAll('.fullscreen-thumbnail-btn').forEach((t, i) => t.classList.toggle('active', i === currentIndex));
    }
    function addFullscreenClasses() {
      track.querySelectorAll('.gallery-slide').forEach(slide => {
        slide.classList.add('fullscreen-slide');
        if (!slide.parentElement.classList.contains('fullscreen-slide-wrapper')) {
          const w = document.createElement('div'); w.className = 'fullscreen-slide-wrapper';
          slide.parentNode.insertBefore(w, slide); w.appendChild(slide);
        }
      });
    }
    function removeFullscreenClasses() {
      track.querySelectorAll('.fullscreen-slide-wrapper').forEach(w => {
        const s = w.querySelector('.gallery-slide');
        if (s) { s.classList.remove('fullscreen-slide'); w.parentNode.insertBefore(s, w); w.remove(); }
      });
    }
    function openFullscreen() {
      fullscreenOverlay.style.display = 'flex';
      generateFullscreenThumbnails();
      fullscreenImageContainer.appendChild(track);
      addFullscreenClasses();
      fullscreenOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    function closeFullscreen() {
      pauseAllVideos();
      fullscreenOverlay.classList.remove('active');
      document.body.style.overflow = '';
      setTimeout(() => {
        removeFullscreenClasses();
        galleryViewport.appendChild(track);
        fullscreenOverlay.style.display = 'none';
      }, 400);
    }
    function toggleVideoPlay(el) {
      if (el.paused) el.play(); else el.pause();
    }
    track.addEventListener('click', (e) => {
      if (window.matchMedia('(max-width: 768px)').matches && touchMoved) return;
      const activeSlide = track.querySelector('.gallery-slide.active');
      if (!activeSlide || !e.target.closest('.gallery-slide.active')) return;
      const player = activeSlide.querySelector('mux-player') || activeSlide.querySelector('video');
      if (player) { e.preventDefault(); toggleVideoPlay(player); return; }
      openFullscreen();
    });
    fullscreenCloseBtn.addEventListener('click', closeFullscreen);
    fullscreenImageContainer.addEventListener('click', (e) => {
      const player = e.target.closest('mux-player') || e.target.closest('video');
      if (player) { e.stopPropagation(); toggleVideoPlay(player); return; }
      closeFullscreen();
    });
    fullscreenPrevBtn.addEventListener('click', (e) => { e.stopPropagation(); goToPrev(); updateFSThumbs(); });
    fullscreenNextBtn.addEventListener('click', (e) => { e.stopPropagation(); goToNext(); updateFSThumbs(); });
    document.addEventListener('keydown', (e) => {
      if (fullscreenOverlay.classList.contains('active')) {
        if (e.key === 'Escape') closeFullscreen();
        else if (e.key === 'ArrowLeft') { e.preventDefault(); goToPrev(); updateFSThumbs(); }
        else if (e.key === 'ArrowRight') { e.preventDefault(); goToNext(); updateFSThumbs(); }
      } else { if (e.key === 'ArrowLeft') goToPrev(); else if (e.key === 'ArrowRight') goToNext(); }
    });
    generateSlides();
    generateThumbnails();
    updateActiveStates();
  </script>
</body>
</html>
